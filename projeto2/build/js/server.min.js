const express=require("express"),bodyParser=require("body-parser"),db=require("./dataBase.min.js"),multer=require("multer"),port=8080,app=express();app.use(express.static(".")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0}));const storage=multer.diskStorage({destination:function(e,s,r){r(null,"./upload")},filename:function(e,s,r){r(null,"imagem."+s.originalname.split(".")[1])}}),upload=multer({storage:storage}).single("arquivo");app.post("/upload",(e,s)=>{upload(e,s,e=>e?s.end("Ocorreu um erro"):void s.end("Concluindo com sucesso."))}),app.post("/users",(e,s)=>{var r=db.newUser({email:e.body.email,password:e.body.password,passwordConfirm:e.body.passwordConfirm,genre:e.body.genre,bornDate:e.body.bornDate,usertype:e.body.usertype});r.password!==r.passwordConfirm?s.send("<h1>Senhas não conferem.</h1>"):s.send("<h1>Usuário Cadastrado</h1>"),console.log(e.body)}),app.get("/users",(e,s)=>{s.send(db.getUsers())}),app.get("/users/:id",(e,s)=>{s.send(db.getUserById(e.params.id))}),app.delete("/users/:id",(e,s)=>{s.send(db.deleteUserById(e.params.id))}),app.listen(port,()=>{console.log("Server Connected")});